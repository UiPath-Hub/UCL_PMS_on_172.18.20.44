{
  "gitSyncId": "67bc192d8c4cb21215539fca_14981c4f-e850-4b5f-a951-74557f2532db",
  "id": "Manage Company Contact__04_UPDATE_CONTACT_LM",
  "pluginId": "mssql-plugin",
  "pluginType": "DB",
  "unpublishedAction": {
    "actionConfiguration": {
      "body": "DECLARE @ResultCode NVARCHAR(10),\n\t\t\t@ResultMessages NVARCHAR(MAX);\n\nIF @@TRANCOUNT = 0\nBEGIN TRANSACTION;\n\tIF({{this.params.ASSIGN_TO_COMPANY?1:0}}=1)\n\tBEGIN\n\t\texecute dbo.[UPDATE_CONTACT_PERSON_DETAIL_V2]\n\t\t\t@COMPANY_CONTACT_ID  = {{COMPANY_CONTACT_ID.text}}\n\t\t,@COMPANY_ID = {{appsmith.URL.queryParams[Configs.editCompany]}}\n\t\t,@COMPANY_CONTACT_ROLE  = {{COMPANY_CONTACT_ROLE.selectedOptionValue}}\n\t\t,@NEWBRANCH = {{appsmith.store.NEWBRANCH}}\n\t\t,@USER_TOKEN = {{appsmith.store[Configs.userSession].TOKEN}}\n\t\t,@IS_INSERT = 1\n\t\t,@ResultCode=@ResultCode OUTPUT\n\t\t,@ResultMessages=@ResultMessages OUTPUT\n\tEND\n\tIF @ResultCode <> 'DONE' GOTO RETURN_RESULT;\n\t\n\tIF({{this.params.UPDATE_ASSIGNED?1:0}}=1)\n\tBEGIN\n\t\t\texecute dbo.[UPDATE_CONTACT_PERSON_DETAIL_V2]\n\t\t\t@COMPANY_CONTACT_ID  = {{COMPANY_CONTACT_ID.text}}\n\t\t,@COMPANY_ID = {{appsmith.URL.queryParams[Configs.editCompany]}}\n\t\t,@COMPANY_CONTACT_ROLE  = {{COMPANY_CONTACT_ROLE.selectedOptionValue}}\n\t\t,@USER_TOKEN = {{appsmith.store[Configs.userSession].TOKEN}}\n\t\t,@NEWBRANCH = {{appsmith.store.NEWBRANCH}}\n\t\t,@IS_UPDATE = 1\n\t\t,@ResultCode=@ResultCode OUTPUT\n\t\t,@ResultMessages=@ResultMessages OUTPUT\n\tEND\n\tIF @ResultCode <> 'DONE' GOTO RETURN_RESULT;\n\n\t\tEXECUTE [dbo].[UPDATE_PMS_COMPANY_CONTACT_LM] \n   @pTitleName = {{TITLE_NAME.selectedOptionValue}}\n  ,@pFirstNameEN = {{COMPANY_CONTACT_FIRST_NAME_EN.text}}\n  ,@pFirstNameTH = {{COMPANY_CONTACT_FIRST_NAME_TH.text}}\n  ,@pSURNameEN = {{COMPANY_CONTACT_SUR_NAME_EN.text}}\n  ,@pSURNameTH = {{COMPANY_CONTACT_SUR_NAME_TH.text}}\n  ,@pTelephone = {{COMPANY_CONTACT_TELEPHONE.text}}\n  ,@pEXT = {{COMPANY_CONTACT_EXT.text}}\n  ,@pMoblie = {{COMPANY_CONTACT_TELEPHONE.text}}\n  ,@pEmail= {{COMPANY_CONTACT_EMAIL.text}}\n  ,@pRole= {{this.params.ASSIGN_TO_COMPANY===1||this.params.UPDATE_ASSIGNED===1?null: COMPANY_CONTACT_ROLE.selectedOptionValue}}\n  ,@pAddNo= {{COMPANY_CONTACT_ADD_NO.text}}\n\t,@pCOMPANY_CONTACT_FLOOR = {{COMPANY_CONTACT_FLOOR.text}}\n  ,@pMoo= {{COMPANY_CONTACT_MOO.text}}\n  ,@pSoiEN= {{COMPANY_CONTACT_SOI_EN.text}}\n  ,@pSoiTH= {{COMPANY_CONTACT_SOI_TH.text}}\n  ,@pRoadEN= {{COMPANY_CONTACT_ROAD_EN.text}}\n  ,@pRoadTH= {{COMPANY_CONTACT_ROAD_TH.text}}\n  ,@pSubdistrictEN= {{ADDRESSING.subdistrict_ConvertToEN (SUB_DISTRICT_TH.selectedOptionValue)}}\n  ,@pSubdistrictTH= {{ADDRESSING.subdistrict_ConvertToTH(SUB_DISTRICT_TH.selectedOptionValue)}}\n  ,@pDistrictEN= {{ADDRESSING.district_ConvertToEN(DISTRICT_TH.selectedOptionValue)}}\n  ,@pDistrictTH= {{ADDRESSING.district_ConvertToTH(DISTRICT_TH.selectedOptionValue)}}\n  ,@pProvinceEN= {{ADDRESSING.province_ConvertToEN(PROVINCE_TH.selectedOptionValue)}}\n  ,@pProvinceTH= {{ADDRESSING.province_ConvertToTH(PROVINCE_TH.selectedOptionValue)}}\n  ,@pPostalCode= {{POSTAL_CODE.text}}\n  ,@pStatus= {{STATUS.selectedOptionValue}}\n\t,@OTHER = {{OTHER.text}}\n\t,@COMPANY_CONTACT_LANGUAGE_TYPE = {{COMPANY_CONTACT_LANGUAGE_TYPE.selectedOptionValue}}\n\t\n\t,@pCOMPANY_CONTACT_ID = {{COMPANY_CONTACT_ID.text}}\n\t,@INSERT_IF_NOT_EXIST = 0\n\t,@UPDATE_NULL = {{this.params.UPDATE_NULL!==undefined?this.params.UPDATE_NULL:1}}\n\t,@USER_TOKEN = {{appsmith.store[Configs.userSession].TOKEN}}\n\t,@ResultCode=@ResultCode OUTPUT\n\t,@ResultMessages=@ResultMessages OUTPUT\n\nIF @ResultCode <> 'DONE' GOTO RETURN_RESULT;\n\nRETURN_RESULT:\nSELECT @ResultCode AS [RESULT_CODE],\n       @ResultMessages AS [RESULT_MESSAGES]\n\nIF @ResultCode = 'DONE'\nCOMMIT TRANSACTION;\nELSE ROLLBACK TRANSACTION;",
      "encodeParamsToggle": true,
      "paginationType": "NONE",
      "pluginSpecifiedTemplates": [
        {
          "value": true
        }
      ],
      "timeoutInMillisecond": 10000
    },
    "confirmBeforeExecute": false,
    "datasource": {
      "id": "UCL_PMS",
      "isAutoGenerated": false,
      "name": "UCL_PMS",
      "pluginId": "mssql-plugin"
    },
    "dynamicBindingPathList": [
      {
        "key": "body"
      }
    ],
    "name": "_04_UPDATE_CONTACT_LM",
    "pageId": "Manage Company Contact",
    "runBehaviour": "MANUAL",
    "userSetOnLoad": false
  }
}