{
  "gitSyncId": "66de956ac05adf72589749ca_bcdaf289-7492-4d7e-a7dd-d94351580c1d",
  "id": "Manage Product Catalog__3_DELETE_CATALOG",
  "pluginId": "mssql-plugin",
  "pluginType": "DB",
  "unpublishedAction": {
    "actionConfiguration": {
      "body": "DECLARE @ResultCode nvarchar(10)\n\t,@ResultMessages NVARCHAR(MAX)\n\t,@Image_IDtoDelete nvarchar(20)\nIF @@TRANCOUNT = 0 \nBEGIN TRANSACTION;\t\n\n\t--delete image\n\tSelect @Image_IDtoDelete = CATALOG_PICTURE FROM dbo.PMS_PRODUCT_CATALOG_LM \n\tWHERE DELETE_FLAG=0 and PRODUCT_ID = {{PRODUCT_ID.text}}\n\t\t\tif @Image_IDtoDelete is not NULL\n\t\t\tbegin\n\t\t\tEXECUTE [dbo].[UPDATE_IMAGE] \n\t\t\t  @TABLE_NAME = 'PMS_CATALOG_PICTURE'\n\t\t\t  ,@USER_TOKEN = {{appsmith.store[Configs.userSession].TOKEN}}\n\t\t\t  ,@DELETE =1\n\t\t\t  ,@IMAGE_ID = @Image_IDtoDelete\n\t\t\t  ,@ResultCode = @ResultCode OUTPUT\n\t\t\t  ,@ResultMessages = @ResultMessages OUTPUT\n\t\t\t\tif @ResultCode<>'DONE'\n\t\t\t\tGOTO OUTPUT;\n\t\t\t\t\n\t\t\tend\n\nEXEC\t[dbo].[UPDATE_PMS_PRODUCT_CATALOG_LM]\n   @PRODUCT_ID = {{PRODUCT_ID.text}}\n\t,@DELETE_FLAG = 1\n  ,@USER_TOKEN = {{appsmith.store[Configs.userSession].TOKEN}}\n\t,@ResultCode=@ResultCode OUTPUT\n\t,@ResultMessages=@ResultMessages  OUTPUT\n\nif @ResultCode <> 'DONE'\nGOTO OUTPUT;\n\t\t\nOUTPUT:\nif @ResultCode <> 'DONE'\nROLLBACK TRANSACTION;\nelse\nCOMMIT TRANSACTION;\nSELECT @ResultCode AS RESULT_CODE , @ResultMessages as RESULT_MESSAGES",
      "encodeParamsToggle": true,
      "paginationType": "NONE",
      "pluginSpecifiedTemplates": [
        {
          "value": true
        }
      ],
      "timeoutInMillisecond": 10000
    },
    "confirmBeforeExecute": false,
    "datasource": {
      "id": "UCL_PMS",
      "isAutoGenerated": false,
      "name": "UCL_PMS",
      "pluginId": "mssql-plugin"
    },
    "dynamicBindingPathList": [
      {
        "key": "body"
      }
    ],
    "name": "_3_DELETE_CATALOG",
    "pageId": "Manage Product Catalog",
    "runBehaviour": "MANUAL",
    "userSetOnLoad": false
  }
}